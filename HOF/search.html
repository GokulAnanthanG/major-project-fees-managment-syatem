<!-- MAJOR PROJECT FESS MANAGEMENT SYSTEM -->
<!-- TEAM -->
<!--
    ****************
    G.GOKUL ANANTHAN
    N.PREM
    N.SATHISH KUMAR
    S.SUDHAKAR
    ****************
UNDER THE GUIDANCE OF
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
MR.Ashok Lingam Sir & MR.Karuppasamy sir
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--font awesome cdn-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!--alert library-->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <!--chart-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
      integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!--bootsrap-->
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
 <!--css-->
 <link rel="stylesheet" href="../assets/css/search.css" />
 <link
   rel="shortcut icon"
   href="../assets/images/favicon.ico"
   type="image/x-icon"
 />
    <title>SSB FESS MANAGEMENT SYSTEM | Search</title>
   
  </head>
  <body> 
    <!-- The sidebar -->
    <div class="sidebar">
        <div class="logo">
            <center>
              <img class="img-responsive" src="../assets/images/logo.png" alt="" />
              <p>SSB</p>
            </center>
            <center>
              <i class="fa fa-user-circle profileIcon"></i>
              <p class="userName">
                <p  id="logDate"></p> 
              </p>
            </center>
          </div>
          <p class="menu-text">Menu</p>
        
        <a  href="dashboard.html">
            <i class="fa fa-home"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Home</span>
          </a>
          <a  href="addPayment.html" title="add fees payments">
            <i class="fa fa-add"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Fees</span>
          </a>
          <a href="recent.html" title="recent payments">
            <i class="fa fa-history"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Recent</span
            >
          </a>
          <a class="active" href="search.html" title="search individual report">
            <i class="fa fa-search"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Search</span
            >
          </a>
          <a href="report.html" title="view payment report and generate report for department">
            <i class="fa fa-clipboard-list"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Report</span
            >
          </a>
        </a>
          <a href="#" id="logout">
            <i class="fa-solid fa-right-from-bracket" title="logout"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Logout</span>
          </a>
    </div>

    <!-- Page content -->
    <div class="content">
        <div class="row  top">
            <div class="col-lg-6">  <h3 class="title"><i class="fa fa-search"></i> Payment</h3></div>
            <div class="col-lg-6 pt-4   ">  
                
            </div>
            <!--row-->
        </div>
<br>
      <div class="container">
      <input type="text" name="rollno" placeholder="roll no" id="rollNo">
      <input type="text" name="batch"placeholder="batch" id="batch">
      <input type="text" name="sem"placeholder="sem" id="sem">
      <button class="search"><i class="fa fa-search"></i></button>
<br>
     <!-- #content-area-->
     <div class="content-area">
     
<div class="major-content">
  <center><i class="spinner-border"></i></center>
 <div class="container">
    <div class="row p-1">
        <div class="col-lg-6 hsitoryStack"></div>
        <div class="col-lg-6 total">
            <table class="table">
<tr>
    <th>Name :</th><td id="name">--</td>
</tr>
<tr>
    <th>Department :</th><td id="department">--</td>
</tr>
<tr>
    <th>Reg No :</th><td id="regNo">--</td>
</tr>
<tr>
    <th>Sem :</th><td id="semInTable">--</td>
</tr>
<tr>
    <th>College Feed Payed :</th><td id="collegeFees">--</td>
</tr>
<tr>
    <th>Skill Fees Payed :</th><td id="skillFees">--</td>
</tr>
<tr>
    <th>Bus Or Van Fees Payed :</th><td id="busOrVanFees">--</td>
</tr>
<tr>    <th>Other Fees Payed :</th><td id="otherFees">--</td>
</tr>
<tr>
    <th>fine Fees Payed :</th><td id="fine">--</td>
</tr>
</table>
        </div>
        <!--row-->
    </div>
    <!--inner container-->
 </div>
   </div>
       <!---end major content-->
<hr>
<!--footer-->
<p align="center" class="m-1">
    &copy; Sri Sankara Bhagavthi Arts & Science College. All Rights
    Reserved
  </p>
<!--footer-->
                <!--container-->
      </div>
    <!--end content-->
</div>
  </body>
  <!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
<!--jquery-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  $(document).ready(()=>{


    try {
  if(JSON.parse(localStorage.getItem("FMSUsEr")).pos!="Handle Only Fees"){
   window.location.href="../index.html";
  }
} catch (error) {
  window.location.href="../index.html";
}
$("#logout").click(()=>{

  swal("Are you sure you want to do this?", {
  buttons: ["cancel", true],
}).then((data)=>{
  if(data==true){
    localStorage.removeItem("FMSUsEr");
window.location.href="../index.html";
  }


})

})
var staffDetail = JSON.parse(localStorage.getItem("FMSUsEr"));
      $(".userName").html(staffDetail.nAmeUSer);
      $("#logDate").html(staffDetail.lDate);

      $(".total table").fadeOut();
  var batch;
        try{
    $("#batch").val(JSON.parse(localStorage.getItem("FMSbATcHSeM")).batch);
    $("#sem").val(JSON.parse(localStorage.getItem("FMSbATcHSeM")).sem)
   }
   catch(err){
    swal("please set the batch & sem", " ", "warning");
   }

   $(".search").click(()=>{
        //getFeesRecords
        $(".spinner-border").css({ display: "inline-block" });

$.ajax({
   method:"post",
  url:"../php/getFeesRecordsForIndivdualStudent.php",
  data: {batch:$("#batch").val(),sem:$("#sem").val(),rollNo :$("#rollNo").val()},
  success:(data)=>{
      if(data!=0||data!=000){
         var RecivedData=JSON.parse(data);
         $(".total table").fadeIn(2000).delay(2000);

         $(".hsitoryStack").empty().append(`<p>History &nbsp;<i class ='fa fa-history'></i></p> 
         <table class='table table-dark'>
            <tr>
                <td>Reg No</td><th> ${RecivedData[0].regNo}</th>
                <td>Batch</td><th> ${RecivedData[0].batch}</th>
                <td>Sem</td><th> ${RecivedData[0].sem}</th>
                 </tr>
            </table>
         `);
var collgeFees=0,skillFees=0,busOrVanFees=0,otherFees=0,fine=0;
         RecivedData.forEach(e => {
             collgeFees+=Number(e.collegeFees);
             skillFees+=Number(e.skillFees);
             busOrVanFees+=Number(e.busOrVanFees);
             otherFees+=Number(e.otherFees);
             fine+=Number(e.fine);

            $(".hsitoryStack").append(`
            <div class='alert alert-secondary'>
                <table class='table table-sm'>
              <tr><td>College Fees:<br> <b>${e.collegeFees}</b></td>
                 <td>Skill Fees:<br> <b>${e.skillFees}</b></td>
                <td>Bus Or van Fees:<br> <b>${e.busOrVanFees}</b></td>
                <td>Other Fees:<br> <b>${e.otherFees}</b></td>
                <td>Fine:<br> <b>${e.fine}</b></td>
                </tr>
                <tr>
                    <td colspan='3' class='bg-warning'>Date: ${e.date}</td>
                    <td colspan='2' class='bg-success'>Toatal: <b>${Number(e.collegeFees)+Number(e.skillFees)+Number(e.busOrVanFees)+Number(e.otherFees)+Number(e.fine) }</b></td>
                   
                    </tr>
                    </table>
                    </div>
            `);
         });//foreach
         $("#name").html(RecivedData[0].name);
         $("#department").html(RecivedData[0].department);
         $("#regNo").html(RecivedData[0].regNo);
         $("#semInTable").html(RecivedData[0].sem);
         $("#collegeFees").html(collgeFees);
         $("#skillFees").html(skillFees);
         $("#otherFees").html(otherFees);
         $("#busOrVanFees").html(busOrVanFees);
         $("#fine").html(fine);

        $(".spinner-border").css({ display: "none" });
      }else if(data==0){
        swal("no payments yet in this semester", " ", "warning");
    $(".spinner-border").css({ display: "none" });
      }
      else  swal("oops something went wrong", " ", "warning");
      $(".spinner-border").css({ display: "none" });

  },
  error:(err)=>{
  console.log(err);
  swal("oops something went wrong", " ", "warning");
  $(".spinner-border").css({ display: "none" });

  }
})
   })
   
  })
</script> 
</html>
