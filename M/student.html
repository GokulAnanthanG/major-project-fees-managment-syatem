<!-- MAJOR PROJECT FESS MANAGEMENT SYSTEM -->
<!-- TEAM -->
<!--
    ****************
    G.GOKUL ANANTHAN
    N.PREM
    N.SATHISH KUMAR
    S.SUDHAKAR
    ****************
UNDER THE GUIDANCE OF
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
MR.Ashok Lingam Sir & MR.Karuppasamy sir
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--font awesome cdn-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
   
    <!--chart-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
      integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!--bootsrap-->
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
  <!--alert library-->
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
 <!--css-->
 <link rel="stylesheet" href="../assets/css/student.css" />
 <link
   rel="shortcut icon"
   href="../assets/images/favicon.ico"
   type="image/x-icon"
 />
    <title>SSB FESS MANAGEMENT SYSTEM | Student</title>
  </head>
  <body> 
    <!-- The sidebar -->
    <div class="sidebar">
        <div class="logo">
            <center>
              <img class="img-responsive" src="../assets/images/logo.png" alt="" />
              <p>SSB</p>
            </center>
           
          </div>
          <center>
            <i class="fa fa-binoculars profileIcon"></i>
            <p class="userName">
              <p  id="logDate"></p> 
            </p>
          </center>
          <p class="menu-text" style="margin-top: -10px;">Menu</p>
        
        <a  href="dashboard.html">
            <i class="fa fa-home"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Home</span>
          </a>
          <a  href="addPayment.html" title="add fees payments">
            <i class="fa fa-add"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Fees</span>
          </a>
          <a href="recent.html" title="recent payments">
            <i class="fa fa-history"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Recent</span
            >
          </a>
          <a href="search.html" title="search individual report">
            <i class="fa fa-search"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Search</span
            >
          </a>
          <a  href="report.html" title="view payment report and generate report for department">
            <i class="fa fa-clipboard-list"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Report</span
            >
          </a>

          <a  class="active"  href="student.html" title="add student & view,edit,delete ">
            <i class="fa fa-user"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Student</span
            >
          </a>
          <a href="#" id="logout">
            <i class="fa-solid fa-right-from-bracket" title="logout"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Logout</span>
          </a>
    </div>

    <!-- Page content -->
    <div class="content">
        <div class="row  top">
            <div class="col-lg-6">  <h3 class="title"><i class="fa fa-user"></i> Student</h3></div>
            <div class="col-lg-6 pt-4   ">  
                
            </div>
            <!--row-->
        </div>
<br>
      <div class="container">
       <!---main content-->
    
       <a href="student.html"><button  title="add student details" class="top-button top-button-active"><i class="fa fa-add"></i>&nbsp;Add</button></a> &nbsp;   <a href="viewStudent.html"><button  class="top-button" title="view student details"><i class="fa fa-eye"></i>&nbsp;view</button></a>
       <br>
     <!-- #content-area-->
     <div class="content-area">
     
<div class="major-content">
<form id="frm" method="post">
    <table>
        <tr>
            <td>
                <label for="regNo">Registration No</label>
                <br>
                <input type="number" name="regNo" id="regNo">
            </td>
          
            <td>
               <label for="rollNo">Roll No</label>
               <br>
               <input type="number" name="rollNo" id="rollNo">
           </td>
        </tr>
      <tr>
      <td>
       <label for="name">Name</label>
       <br>
       <input type="text" autocomplete="off" name="name" id="name">
      </td>
      <td>
       <label for="batch">Batch</label>
       <br>
       <input type="text" placeholder="20192021" name="batch" id="batch">
      </td>
      </tr>
        <tr>
        
           <td>
               <label for="department">Department</label>
               <br>
                <select name="department" id="department">
                    <option value="">--</option>
                    <option value="BCA">BCA</option>
                    <option value="B.Com">B.Com</option>
                    <option value="BBA">BBA</option>
                    <option value="Bsc(IT)">Bsc(IT)</option>
                    <option value="Bsc(Maths)">Bsc(Maths)</option>
                    <option value="BA(English)">BA(English)</option>
                    <option value="M.Com">M.Com</option>
                </select>
           </td>
           <td>
             <label for="vanOrBusFees">Van or Bus Fees</label>
             <br>
             <input type="number" value="0" name="vanOrBusFees" id="vanOrBusFees">
         </td>
        </tr>
        <tr>
          <tr><td><label for="gender">Gender</label><br>
          <select name="gender" id="gender">
            <option value="">--</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
         </td>
         <td><label for="">Skill</label>&nbsp;<span class="text-warning" id="skillInfo"></span><br>
          <select name="skill" id="skill">
            <option value="">--</option>
          </select>
         </td>
        </tr>
         <td colspan="2"> <center><label for="">or</label></center></td>
      </tr>
        <tr>
         <td colspan="2"> <label for=" ">Import Data</label>
           <br> 
           <p align="center" id="fileName"></p>
           <label for="importData" title="import data through excelsheet"> <i   class="fa fa-file-excel importBtn "></i> </label></td>
           
       </tr>
      <tr>
       <td colspan="2"><button type="button" class="addButton"><i class="spinner-border"></i><i   class="fa fa-add btnText"></i><span class="btnText">Add</span>
    
      </button></td>
      </tr>
      <tr>
      <td> <input type="file" name="importData" id="importData"></td>
      </tr>
      </table>
    </form>
</div>
       <!---end major content-->
<hr>
<!--footer-->
<p align="center" class="m-1">
    &copy; Sri Sankara Bhagavthi Arts & Science College. All Rights
    Reserved
  </p>
<!--footer-->
                <!--container-->
      </div>
    <!--end content-->
</div>
 <!-- JavaScript Bundle with Popper -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
 <script>
   $(document).ready(() => {
    try {
  if(JSON.parse(localStorage.getItem("FMSUsEr")).pos!="Manager"){
   window.location.href="../index.html";
  }
} catch (error) {
  window.location.href="../index.html";
}
$("#logout").click(()=>{

  swal("Are you sure you want to do this?", {
  buttons: ["cancel", true],
}).then((data)=>{
  if(data==true){
    localStorage.removeItem("FMSUsEr");
window.location.href="../index.html";
  }
})
})


      var staffDetail = JSON.parse(localStorage.getItem("FMSUsEr"));
      $(".userName").html(staffDetail.nAmeUSer);
      $("#logDate").html(staffDetail.lDate);

  $(".addButton").click(() => {
    var regNoStatus = false,
      rollNoStatus = false,
      nameStatus = false,
      batchStatus = false,
      departmentStatus = false,
      vanOrBusFeesStatus = false,
      genderStatus = false,
      skillStatus = false;
    if ($("#regNo").val() != "") {
      $("#regNo").css({ "border-color": " black" });
      regNoStatus = true;
    } else {
      $("#regNo").css({ "border-color": "red" });
      regNoStatus = false;
    }
    //regNo
    if ($("#rollNo").val() != "") {
      $("#rollNo").css({ "border-color": " black" });
      rollNoStatus = true;
    } else {
      $("#rollNo").css({ "border-color": "red" });
      rollNoStatus = false;
    }
    //rollNo

    if ($("#name").val() != "") {
      $("#name").css({ "border-color": " black" });
      nameStatus = true;
    } else {
      $("#name").css({ "border-color": "red" });
      nameStatus = false;
    }
    //name
    if ($("#batch").val() != "") {
      $("#batch").css({ "border-color": " black" });
      batchStatus = true;
    } else {
      $("#batch").css({ "border-color": "red" });
      batchStatus = false;
    }
    //batch
    if ($("#department").val() != "") {
      $("#department").css({ "border-color": " black" });
      departmentStatus = true;
    } else {
      $("#department").css({ "border-color": "red" });
      departmentStatus = false;
    }
    //department
    if ($("#vanOrBusFees").val() != "") {
      $("#vanOrBusFees").css({ "border-color": " black" });
      vanOrBusFeesStatus = true;
    } else {
      $("#vanOrBusFees").css({ "border-color": "red" });
      vanOrBusFeesStatus = false;
    }
    //vanOrBusFees
    if ($("#gender").val() != "") {
      $("#gender").css({ "border-color": " black" });
      genderStatus = true;
    } else {
      $("#gender").css({ "border-color": "red" });
      genderStatus = false;
    }
    //gender
    if ($("#skill").val() != "") {
      $("#skill").css({ "border-color": " black" });
      skillStatus = true;
    } else {
      $("#skill").css({ "border-color": "red" });
      skillStatus = false;
    }
    //gender
    //condition
    if (String(fileNameChosed).length == 0) {
      if (
        regNoStatus &&
        rollNoStatus &&
        nameStatus &&
        batchStatus &&
        departmentStatus &&
        vanOrBusFeesStatus &&
        genderStatus &&
        skillStatus
      ) {
        swal("Are you sure you want to do this?", {
          buttons: ["cancel", true],
        }).then((data) => {
          if (data) {
            $(".spinner-border").css({ display: "inline-block" });
            $(".btnText").css({ display: "none" });
            $.ajax({
              type: "POST",
              url: "../php/addStudent.php",
              data: $("#frm").serialize(),
              success: (data) => {
                console.log(data);
                if (data == 1) {
                  swal({
                    title: "student added",
                    icon: "success",
                    button: "ok",
                  });
                  $(".spinner-border").css({ display: "none" });
                  $(".btnText").css({ display: "inline-block" });
                  $("#frm")[0].reset();
                } else {
                  $(".spinner-border").css({ display: "none" });
                  $(".btnText").css({ display: "inline-block" });
                  swal("oops something went wrong :(", " ", "error");
                }
              },
              error: (err) => {
                console.log(err);
                swal("oops something went wrong :(", " ", "error");
                $(".spinner-border").css({ display: "none" });
                $(".btnText").css({ display: "inline-block" });
              },
            });
          }
        }); //swal
      } else {
        swal("please fill all the fields", " ", "warning");
      }
    } //if
    else {
      swal("Are you sure you want to do this?", {
        buttons: ["cancel", true],
      }).then((data) => {
        if (data == true) {
          $(".spinner-border").css({ display: "inline-block" });
          $(".btnText").css({ display: "none" });
          var formdata = new FormData();
          formdata.append("file", FileExcelFile);
          formdata.append("fileStatus", true);
          $.ajax({
            method: "post",
            url: "./php/addStudentThroughExcel.php",
            data: formdata,
            contentType: false,
            processData: false,
            success: (data) => {
              if (data == 1) {
                $(".spinner-border").css({ display: "none" });
                $(".btnText").css({ display: "inline-block" });
                fileNameChosed = " ";
                FileExcelFile = " ";
                swal({
                  title: "students added",
                  icon: "success",
                  button: "ok",
                });
              } else {
                $(".spinner-border").css({ display: "none" });
                $(".btnText").css({ display: "inline-block" });
                swal(
                  "oops something went wrong :( failed to add the students",
                  " ",
                  "error"
                );
              }
            },
            error: (err) => {
              swal("oops something went wrong", " ", "error");
            },
          }); //ajax
        }
      }); //promise
    } //else
  }); //button

  //getSkills
  $("#batch").keyup(function () {
    $("#skill").html("<option value=''>--</option>");
    $.ajax({
      method: "POST",
      url: "../php/getSkillToAddStudent.php",
      data: { batch: $("#batch").val() },
      success: (data) => {
        console.log(JSON.parse(data));
        if (data != 0) {
          $("#skillInfo").html(" ");
          let parsedData = JSON.parse(data);
          parsedData.forEach((e, i) => {
            console.log(i);
            if (i % 2 == 0) {
              $("#skill").append(
                `<option value='${e.value}'>${e.value}</option>`
              );
            }
          });
        } else if (data == 0) {
          $("#skillInfo").html("no skills added for this batch");
        }
      },
      error: (err) => {
        console.log(err);
        swal(
          "oops something went wrong :( failed to fetch skills",
          " ",
          "error"
        );
      },
    });
  });
  //file change
  var fileNameChosed = "";
  var FileExcelFile;
  $("#importData").change((e) => {
    fileNameChosed = "";
    $("#fileName").html("");
    FileExcelFile = $("#importData")[0].files[0];
    fileNameChosed = $("#importData")[0].files[0].name;
    $("#fileName").html(fileNameChosed);
    $("#importData")[0].files[0];
  }); //file change
});

 </script>
  </body>
 
</html>
