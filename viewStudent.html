<!-- MAJOR PROJECT FESS MANAGEMENT SYSTEM -->
<!-- TEAM -->
<!--
    ****************
    G.GOKUL ANANTHAN
    N.PREM
    N.SATHISH KUMAR
    S.SUDHAKAR
    ****************
UNDER THE GUIDANCE OF
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
MR.Ashok Lingam Sir & MR.Karuppasamy sir
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--font awesome cdn-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
   
    <!--chart-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
      integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!--bootsrap-->
    <!--alert library-->
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
 <!--css-->
 <link rel="stylesheet" href="./assets/css/viewStudent.css" />
 <link
   rel="shortcut icon"
   href="assets/images/favicon.ico"
   type="image/x-icon"
 />
    <title>SSB FESS MANAGEMENT SYSTEM | ADMIN View Student</title>
  </head>
  <body> 
    <!-- The sidebar -->
    <div class="sidebar">
        <div class="logo">
            <center>
              <img class="img-responsive" src="./assets/images/logo.png" alt="" />
              <p>SSB</p>
            </center>
          </div>
          <p class="menu-text">Menu</p>
        
        <a  href="dashboard.html">
            <i class="fa fa-home"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Home</span>
          </a>
          <a  href="addPayment.html" title="add fees payments">
            <i class="fa fa-add"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Fees</span>
          </a>
          <a href="student.html" title="recent payments">
            <i class="fa fa-history"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Recent</span
            >
          </a>
          <a href="student.html" title="search individual report">
            <i class="fa fa-search"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Search</span
            >
          </a>
          <a href="student.html" title="view payment report and generate report for department">
            <i class="fa fa-clipboard-list"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Report</span
            >
          </a>
        </a>
        <a href="staff.html" title="add staff & view,edit,delete ">
          <i class="fa fa-user-circle"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
            >Staff</span
          >
        </a>
          <a class="active" href="student.html" title="add student & view,edit,delete ">
            <i class="fa fa-user"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span
              >Student</span
            >
          </a>
          <a href="setting.html" title="add sem fees for department , skill fees and rest pass">
            <i class="fa fa-gear"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Settings</span>
          </a>
          <a href="#">
            <i class="fa-solid fa-right-from-bracket" title="logout"></i>&nbsp;&nbsp;&nbsp;&nbsp;<span>Logout</span>
          </a>
    </div>

    <!-- Page content -->
    <div class="content">
        <div class="row  top">
            <div class="col-lg-6">  <h3 class="title"><i class="fa fa-user"></i> Student</h3></div>
            <div class="col-lg-6 pt-4   ">  
                
            </div>
            <!--row-->
        </div>
<br>
      <div class="container">
       <!---main content-->
    
       <a href="student.html"><button  title="add student details" class="top-button "><i class="fa fa-add"></i>&nbsp;Add</button></a> &nbsp;   <a href="viewStudent.html"><button  class="top-button top-button-active" title="view student details"><i class="fa fa-eye"></i>&nbsp;view</button></a>
       <br>
     <!-- #content-area-->
     <div class="content-area">
     
<div class="major-content">
   <div class="table-box">
    <table class="nav-table">
        <tr>
            <td>
                <label for="regNo">Roll No</label>
                <br>
                <input type="text" id="rollNo">
            </td>
            <td>
              <label for="batch">Batch</label>
              <br>
              <input class="shortInp" type="text" id="batch">
             
          </td>
            <td>
               <label for=" "> </label>
               <br>
               <button id="search" title="individual search"><i class="fa fa-search"></i></button>
              
           </td>
           <td>
               <label for=" "> </label>
               <br>
               <button id="displayAll" title="display all the records"><i class="fa fa-arrow-down"></i></button>
           </td>
          
           <td>
               <label for=" ">department</label>
               <br>
               <select class="shortInp" name="" id="department">
                   <option value="">--</option>
                   <option value="BCA">BCA</option>
                   <option value="B.Com">B.Com</option>
                   <option value="BBA">BBA</option>
                   <option value="Bsc(IT)">Bsc(IT)</option>
                   <option value="Bsc(Maths)">Bsc(Maths)</option>
                   <option value="BA(English)">BA(English)</option>
                   <option value="M.Com">M.Com</option>
               </select>
              
           </td>
           <td>
               <label for=" "> </label>
               <br>
               <button id="filter" title="filter department wise"><i class="fa fa-filter"></i></button>
           </td>
    </table>
    <div class="student-list">
      <center> <i class="spinner-border spinner1"></i></center>
             <table class="student-list-table">
                 <tr><th>Reg No</th><th>Student Name</th> <th>Batch</th> <th>Department</th>  </tr>
                  
   
                 
             </table>
</div>
       <!--end table-box-->
   </div>
</div>
       <!---end major content-->
<hr>
<!--footer-->
<p align="center" class="m-1">
    &copy; Sri Sankara Bhagavthi Arts & Science College. All Rights
    Reserved
  </p>
<!--footer-->
                <!--container-->
      </div>
    <!--end content-->
</div>
  </body>
  <!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
<!--jquery-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  $(document).ready(()=>{
    $("#batch").val(JSON.parse(localStorage.getItem("FMSbATcHSeM")).batch)
    function getAllStudent(){
      $(".spinner1").css({ display: "inline-block" });
   var batch=   JSON.parse(localStorage.getItem("FMSbATcHSeM")).batch;
     $.ajax({
      type: "POST",
        url: "./php/getAllStudent.php",
        data:{batch:batch},
        success:(data)=>{ 
            if(data!=00){
              var data = JSON.parse(data)
            $(".spinner1").css({ display: "none" });
            $(".student-list-table").empty().append("<tr><th>Reg No</th><th>Student Name</th> <th>Batch</th> <th>Department</th>  </tr>");
             data.forEach(e => {
                  $(".student-list-table").append(`<tr><td>${e.regNo}</td> <td>${e.name}</td>
                    <td>${e.batch}</td> <td>${e.department}</td>
                  <td><button eid='${e.rollNo}' title="view student record" class="action action3"><i class="fa fa-eye"></i></button></td>
                  <td><button eid='${e.rollNo}' title="edit record" class="action action1"><i class="fa fa-pencil"></i></button></td>
              <td><button title="delete permanently" eid='${e.id}' class="action action2"><i class="fa fa-trash"></i></button></td><tr>`)
            });
          }
          else if(data==00){
            $(".student-list-table").empty();
            $(".student-list-table").append(`<tr><td colspan='5'><p align="center">No Records</p></td></tr>`);
            $(".spinner1").css({ display: "none" });
          }
        },
        error:(err)=>{
          $(".spinner1").css({ display: "none" });
          console.log(err);
          swal("oops something went wrong :(", " ", "error");
        }
    })
    }//fn
    getAllStudent();

$("#displayAll").click(()=>{
  getAllStudent();
})

$("#search").click(()=>{
  if($("#rollNo").val()!=""&&$("#rollNo").val()!=""){
    $(".spinner1").css({ display: "inline-block" });
   var batch=   JSON.parse(localStorage.getItem("FMSbATcHSeM")).batch;
     $.ajax({
      type: "POST",
        url: "./php/getInduvidualStudent.php",
        data:{batch:batch,rollNo:$("#rollNo").val()},
        success:(data)=>{ 
            if(data!=00){
              var data = JSON.parse(data)
            $(".spinner1").css({ display: "none" });
            $(".student-list-table").empty().append("<tr><th>Reg No</th><th>Student Name</th> <th>Batch</th> <th>Department</th>  </tr>");
             data.forEach(e => {
                  $(".student-list-table").append(`<tr><td>${e.regNo}</td> <td>${e.name}</td>
                    <td>${e.batch}</td> <td>${e.department}</td>
                  <td><button eid='${e.rollNo}' title="view student record" class="action action3"><i class="fa fa-eye"></i></button></td>
                  <td><button eid='${e.rollNo}' title="edit record" class="action action1"><i class="fa fa-pencil"></i></button></td>
              <td><button title="delete permanently" eid='${e.id}' class="action action2"><i class="fa fa-trash"></i></button></td><tr>`)
            });
          }
          else if(data==00){
            $(".student-list-table").empty();
            $(".student-list-table").append(`<tr><td colspan='5'><p align="center">No Records</p></td></tr>`);
            $(".spinner1").css({ display: "none" });
          }
        },
        error:(err)=>{
          $(".spinner1").css({ display: "none" });
          console.log(err);
          swal("oops something went wrong :(", " ", "error");
        }
    })
  }
  else{
    swal("please enter the roll no and batch", " ", "warning");
  }
 })//search


 $("#filter").click(()=>{
  if($("#department").val()!=""&&$("#batch").val()!=""){
    $(".spinner1").css({ display: "inline-block" });
   var batch=   JSON.parse(localStorage.getItem("FMSbATcHSeM")).batch;
     $.ajax({
      type: "POST",
        url: "./php/getStudentDepartmentWise.php",
        data:{batch:batch,department:$("#department").val()},
        success:(data)=>{ 
            if(data!=00){
              var data = JSON.parse(data)
            $(".spinner1").css({ display: "none" });
            $(".student-list-table").empty().append("<tr><th>Reg No</th><th>Student Name</th> <th>Batch</th> <th>Department</th>  </tr>");
             data.forEach(e => {
                  $(".student-list-table").append(`<tr><td>${e.regNo}</td> <td>${e.name}</td>
                    <td>${e.batch}</td> <td>${e.department}</td>
                  <td><button eid='${e.rollNo}' title="view student record" class="action action3"><i class="fa fa-eye"></i></button></td>
                  <td><button eid='${e.rollNo}' title="edit record" class="action action1"><i class="fa fa-pencil"></i></button></td>
              <td><button title="delete permanently" eid='${e.id}' class="action action2"><i class="fa fa-trash"></i></button></td><tr>`)
            });
          }
          else if(data==00){
            $(".student-list-table").empty();
            $(".student-list-table").append(`<tr><td colspan='5'><p align="center">No Records</p></td></tr>`);
            $(".spinner1").css({ display: "none" });
          }
        },
        error:(err)=>{
          $(".spinner1").css({ display: "none" });
          console.log(err);
          swal("oops something went wrong :(", " ", "error");
        }
    })
  }
  else{
    $(".spinner1").css({ display: "none" });
    swal("please enter the department and batch", " ", "warning");
  }
 })//filter

 //delete

 $(document).on("click",".action2",function(){

  var delId=$(this).attr("eid");
  swal({
  title: "Are you sure?",
  text: "Once deleted, unable to recover this record ",
  icon: "warning",
  buttons: true,
  dangerMode: true,
})
.then((willDelete) => {
  if (willDelete) {

    $(".spinner1").css({ display: "inline-block" });
    var batch=   JSON.parse(localStorage.getItem("FMSbATcHSeM")).batch;
    $.ajax({
      type: "POST",
        url: "./php/deleteStudent.php",
        data:{batch:batch,id:delId},
        success:(data)=>{ 
            if(data!=0){
              getAllStudent();
              swal("record has been deleted!", {
      icon: "success",
    });
              $(".spinner1").css({ display: "none" });
            }
            else{
              $(".spinner1").css({ display: "none" });
              swal("oops something went wrong :(", " ", "warning"); 
            }
    },
    error:(err)=>{
      $(".spinner1").css({ display: "none" });
      swal("oops something went wrong :(", " ", "warning");
    }
  })//ajax
   
  } else {
    swal("this record is safe!");
  }
});
 })//delete 

 //view stdudent
$(document).on("click",".action3",function (){
  var rollNo=$(this).attr("eid");
   window.location.replace(`viewStudentRecord.html?rollNo=${rollNo}&batch=${$("#batch").val()}`);
})
//edit
$(document).on("click",".action1",function (){
  var rollNo=$(this).attr("eid");
   window.location.replace(`editStudentRecord.html?rollNo=${rollNo}&batch=${$("#batch").val()}`);
})

        })
</script>
</html>
